<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>美图WEB开放平台</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="http://open.web.meitu.com/sources/xiuxiu.js" type="text/javascript"></script>
<script src="http://hao.91nzh.com/static/js/jquery3.2.1.min.js"></script>
<script src="/js/layer/layer.js"></script>
<!-- 提示:: 如果你的网站使用https, 将xiuxiu.js地址的请求协议改成https即可 -->
<script type="text/javascript">
window.onload=function(){
	/*第1个参数是加载编辑器div容器，第2个参数是编辑器类型，第3个参数是div容器宽，第4个参数是div容器高*/
	var default_pic = 'http://open.web.meitu.com/sources/images/1.jpg';
	var user_pic = $('#user_pic').val();
	var avatar_url = 'http://localhost:3000' + user_pic;
	if (!user_pic) {
		avatar_url = default_pic;
	}

	xiuxiu.embedSWF("altContent",5,"100%","100%");
       //修改为您自己的图片上传接口
	xiuxiu.setUploadURL("http://localhost:3000/myAccount/upload_pic");
        xiuxiu.setUploadType(2);
        xiuxiu.setUploadDataFieldName("upload_file");
	xiuxiu.onInit = function ()
	{
		xiuxiu.loadPhoto(avatar_url);
	}	
	xiuxiu.onUploadResponse = function (data)
	{
		//alert("上传响应" + data);  可以开启调试
		if(data){
			layer.msg('上传成功',{time:2000,icon:1});
			layer.closeAll('iframe');
			setTimeout(() => {
				window.parent.location.reload();
			}, 2000);
			return false;
		}
	}
}
</script>
<style type="text/css">
	html, body { height:100%; overflow:hidden; }
	body { margin:0; }
</style>
</head>
<body>
	<input type="hidden" value="<%= userInfo.pic %>" id="user_pic">
<div id="altContent">
	<h1>美图秀秀</h1>
</div>
</body>
</html>